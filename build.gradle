plugins {
    id 'io.spring.dependency-management' version '1.0.9.RELEASE' apply false
    id 'org.springframework.boot' version '2.2.6.RELEASE' apply false
    id "org.flywaydb.flyway" version "6.5.2" apply false
    id "com.github.spotbugs" version "4.0.2"
    id 'jacoco'
    id 'checkstyle'
}

configure(allprojects) { project ->
    apply plugin: "io.spring.dependency-management"

    group 'com.evernote'
    version '1.0-SNAPSHOT'

    dependencyManagement {
        imports {
            mavenBom 'org.springframework.boot:spring-boot-dependencies:2.3.2.RELEASE'
        }

        dependencies {
            dependency "net.rakugakibox.spring.boot:orika-spring-boot-starter:1.9.0"
            dependency "org.testcontainers:postgresql:1.14.1"
            dependency "org.flywaydb:flyway-core:6.5.2"
            dependency "io.springfox:springfox-swagger-ui:2.9.2"
            dependency "io.springfox:springfox-swagger2:2.9.2"
        }

        repositories {
            mavenCentral()
        }
    }
}

configure(subprojects) { project ->
    apply plugin: 'java'
    apply plugin: 'checkstyle'
    apply plugin: 'com.github.spotbugs'
    apply plugin: 'jacoco'

    checkstyle {
        toolVersion = '8.31'
    }

    spotbugs {
        excludeFilter = file('../config/spotbugs/spotbugs-exclude.xml')
    }

    jacoco {
        toolVersion = "0.8.5"
        reportsDir = file("$buildDir/jacocoReportDir")
    }

    sourceCompatibility = JavaVersion.VERSION_14
    targetCompatibility = JavaVersion.VERSION_14
}
